{%- set name = name|default('Varnish Cache') -%}

{%- set description = description|default('') -%}

{%- set seed = ['Allenta', 'Varnish Cache']|join('/') -%}

{%- set master = 'varnish.stats["{$VARNISH_CACHE.LOCATIONS}"]' -%}

{#-#########################################################################-#}
{#- MACROS -#}
{#-#########################################################################-#}

{%- macro trigger(definition) -%}
    {% if version not in ('5.0', '5.2') %}
        <uuid>{{ [seed, definition.id]|join('/')|zuuid }}</uuid>
    {% endif %}
    <expression>{{ definition.expression|e }}</expression>
    <name>{{ definition.name|e }}</name>
    <priority>{{ definition.priority }}</priority>
    {% if 'recovery' in definition %}
        <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
        <recovery_expression>{{ definition.recovery|e }}</recovery_expression>
    {% else %}
        <recovery_mode>EXPRESSION</recovery_mode>
        <recovery_expression/>
    {% endif %}
{%- endmacro -%}

{%- macro discovery_rule(rule, items, triggers) -%}
    <discovery_rule>
        {% if version not in ('5.0', '5.2') %}
            <uuid>{{ [seed, rule.id]|join('/')|zuuid }}</uuid>
        {% endif %}
        <name>{{ rule.name|e }}</name>
        <type>ZABBIX_ACTIVE</type>
        <key>{{ rule.key|e }}</key>
        <delay>{$VARNISH_CACHE.LLD_UPDATE_INTERVAL:&quot;{{ rule.context }}&quot;}</delay>
        <lifetime>{$VARNISH_CACHE.LLD_KEEP_LOST_RESOURCES_PERIOD:&quot;{{ rule.context }}&quot;}</lifetime>
        {% if rule.context != 'items' %}
            <filter>
                <conditions>
                    <condition>
                        <formulaid>A</formulaid>
                        <macro>{{ '{#' }}SUBJECT}</macro>
                        <operator>NOT_MATCHES_REGEX</operator>
                        <value>{$VARNISH_CACHE.LLD_EXCLUDED_SUBJECTS:&quot;{{ rule.context }}&quot;}</value>
                    </condition>
                </conditions>
            </filter>
        {% endif %}
        <item_prototypes>
            {% for item in items %}
                <item_prototype>
                    {% if version not in ('5.0', '5.2') %}
                        <uuid>{{ [seed, item.id]|join('/')|zuuid }}</uuid>
                    {% endif %}
                    <name>Varnish Cache[{{ '{#' }}LOCATION}] - {{ item.name|e }}</name>
                    <type>{{ item.type }}</type>
                    <key>{{ item.key|e }}</key>
                    {% if 'delay' in item and item.delay %}
                        <delay>{$VARNISH_CACHE.ITEM_UPDATE_INTERVAL}</delay>
                    {% else %}
                        <delay>0</delay>
                    {% endif %}
                    {% if 'history' in item and not item.history %}
                        <history>0</history>
                    {% else %}
                        <history>{$VARNISH_CACHE.ITEM_HISTORY_STORAGE_PERIOD}</history>
                    {% endif %}
                    {% if 'trends' in item and not item.trends %}
                        <trends>0</trends>
                    {% else %}
                        <trends>{$VARNISH_CACHE.ITEM_TREND_STORAGE_PERIOD}</trends>
                    {% endif %}
                    <value_type>{{ item.value_type }}</value_type>
                    <units>{{ item.units|default('')|e }}</units>
                    <params>{{ item.params|default('')|e }}</params>
                    {% if version in ('5.0', '5.2') %}
                        <applications>
                            <application>
                                <name>Varnish Cache</name>
                            </application>
                        </applications>
                    {% else %}
                        <tags>
                            <tag>
                                <tag>Application</tag>
                                <value>Varnish Cache</value>
                            </tag>
                        </tags>
                    {% endif %}
                    {% if 'master_item_key' in item %}
                        <master_item>
                            <key>{{ item.master_item_key|e }}</key>
                        </master_item>
                    {% endif %}
                    {% if 'preprocessing' in item %}
                        <preprocessing>
                            {% for step in item.preprocessing %}
                                <step>
                                    <type>{{ step.type }}</type>
                                    {% if version == '5.0' -%}
                                        <params>{{ step.params|default('')|e }}</params>
                                    {% else %}
                                        <parameters>
                                            <parameter>{{ step.params|default('')|e }}</parameter>
                                        </parameters>
                                    {% endif %}
                                    <error_handler>{{ step.error_handler|default('ORIGINAL_ERROR') }}</error_handler>
                                    <error_handler_params/>
                                </step>
                            {% endfor %}
                        </preprocessing>
                    {% endif %}
                </item_prototype>
            {% endfor %}
        </item_prototypes>
        <trigger_prototypes>
            {% for definition in triggers %}
                <trigger_prototype>
                    {{ trigger(definition) }}
                </trigger_prototype>
            {% endfor %}
        </trigger_prototypes>
    </discovery_rule>
{%- endmacro -%}

{#-#########################################################################-#}
{#- MAIN -#}
{#-#########################################################################-#}

<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>{{ version }}</version>
    <date>2018-12-28T11:56:28Z</date>
    <groups>
        <group>
            {% if version not in ('5.0', '5.2') %}
                <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            {% endif %}
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            {% if version not in ('5.0', '5.2') %}
                <uuid>{{ [seed]|join('/')|zuuid }}</uuid>
            {% endif %}
            <template>Template App {{ name|e }}</template>
            <name>Template App {{ name|e }}</name>
            {% if description %}
                <description>{{ description|e }}</description>
            {% endif %}
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            {% if version in ('5.0', '5.2') %}
                <applications>
                    <application>
                        <name>Varnish Cache</name>
                    </application>
                </applications>
            {% endif %}

            {#-#############################################################-#}
            {#- ITEMS -#}
            {#-#############################################################-#}

            <items>
                {% for item in [
                        {
                            'id': 'item-1',
                            'name': 'stats',
                            'key': master,
                            'history': false,
                            'trends': false,
                            'value_type': 'TEXT',
                            'triggers': [],
                        },
                        {
                            'id': 'item-2',
                            'name': '$1 processes',
                            'key': 'proc.num[varnishd]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-2.1',
                                    'name': 'Varnish Cache is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[varnishd].last()}'
                                        '<{$VARNISH_CACHE.VARNISH_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[varnishd])'
                                        '<{$VARNISH_CACHE.VARNISH_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-3',
                            'name': '$1 processes',
                            'key': 'proc.num[varnishncsa]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-3.1',
                                    'name': 'Varnish NCSA log is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[varnishncsa].last()}'
                                        '<{$VARNISH_CACHE.NCSA_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[varnishncsa])'
                                        '<{$VARNISH_CACHE.NCSA_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-4',
                            'name': '$1 processes',
                            'key': 'proc.num[varnishlog]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-4.1',
                                    'name': 'Varnish raw log is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[varnishlog].last()}'
                                        '<{$VARNISH_CACHE.RAW_LOG_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[varnishlog])'
                                        '<{$VARNISH_CACHE.RAW_LOG_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-5',
                            'name': '$1 processes',
                            'key': 'proc.num[varnish-agent]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-5.1',
                                    'name': 'Varnish Agent is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[varnish-agent].last()}'
                                        '<{$VARNISH_CACHE.AGENT_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[varnish-agent])'
                                        '<{$VARNISH_CACHE.AGENT_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-6',
                            'name': '$1 processes',
                            'key': 'proc.num[broadcaster]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-6.1',
                                    'name': 'Varnish Broadcaster is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[broadcaster].last()}'
                                        '<{$VARNISH_CACHE.BROADCASTER_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[broadcaster])'
                                        '<{$VARNISH_CACHE.BROADCASTER_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-7',
                            'name': '$1 processes',
                            'key': 'proc.num[vcs-agent]',
                            'value_type': 'UNSIGNED',
                            'triggers': [
                                {
                                    'id': 'trigger-7.1',
                                    'name': 'VCS Agent is not running',
                                    'expression':
                                        '{Template App ' + name + ':proc.num[vcs-agent].last()}'
                                        '<{$VARNISH_CACHE.VCS_AGENT_PROCESSES.MIN}'
                                        if version in ('5.0', '5.2') else
                                        'last(/Template App ' + name + '/proc.num[vcs-agent])'
                                        '<{$VARNISH_CACHE.VCS_AGENT_PROCESSES.MIN}',
                                    'priority': 'DISASTER',
                                },
                            ],
                        },
                        {
                            'id': 'item-8',
                            'name': 'varnishd mem.vsize (virtual memory size)',
                            'key': 'proc.mem["{$VARNISH_CACHE.PROC_MEM.VARNISHD.NAME}",,,,vsize]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'triggers': [],
                        },
                        {
                            'id': 'item-9',
                            'name': 'varnishd mem.rss (resident set size)',
                            'key': 'proc.mem["{$VARNISH_CACHE.PROC_MEM.VARNISHD.NAME}",,,,rss]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'triggers': [],
                        },
                        {
                            'id': 'item-10',
                            'name': 'varnishd mem.size (size of process code + data + stack segments)',
                            'key': 'proc.mem["{$VARNISH_CACHE.PROC_MEM.VARNISHD.NAME}",,,,size]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'triggers': [],
                        },
                        {
                            'id': 'item-11',
                            'name': 'varnishd mem.swap (size of swap space used)',
                            'key': 'proc.mem["{$VARNISH_CACHE.PROC_MEM.VARNISHD.NAME}",,,,swap]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'triggers': [],
                        },
                    ] %}
                    <item>
                        {% if version not in ('5.0', '5.2') %}
                            <uuid>{{ [seed, item.id]|join('/')|zuuid }}</uuid>
                        {% endif %}
                        <name>Varnish Cache - {{ item.name|e }}</name>
                        <type>ZABBIX_ACTIVE</type>
                        <key>{{ item.key|e }}</key>
                        <delay>{$VARNISH_CACHE.ITEM_UPDATE_INTERVAL}</delay>
                        {% if 'history' in item and not item.history %}
                            <history>0</history>
                        {% else %}
                            <history>{$VARNISH_CACHE.ITEM_HISTORY_STORAGE_PERIOD}</history>
                        {% endif %}
                        {% if 'trends' in item and not item.trends %}
                            <trends>0</trends>
                        {% else %}
                            <trends>{$VARNISH_CACHE.ITEM_TREND_STORAGE_PERIOD}</trends>
                        {% endif %}
                        <value_type>{{ item.value_type }}</value_type>
                        <units>{{ item.units|default('')|e }}</units>
                        {% if version in ('5.0', '5.2') %}
                            <applications>
                                <application>
                                    <name>Varnish Cache</name>
                                </application>
                            </applications>
                        {% else %}
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Varnish Cache</value>
                                </tag>
                            </tags>
                        {% endif %}
                        {% if item.triggers %}
                            <triggers>
                                {% for definition in item.triggers %}
                                    <trigger>
                                        {{ trigger(definition) }}
                                    </trigger>
                                {% endfor %}
                            </triggers>
                        {% endif %}
                        {% if item.name == 'stats' %}
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    {% if version == '5.0' %}
                                        <params>
                                    {% else %}
                                        <parameters><parameter>
                                    {% endif %}
                                        var exclusions = '{$VARNISH_CACHE.EXCLUDED_STATS}'.trim();

                                        // This check is not just a simple optimization to avoid using never matching
                                        // regexps like '^(?!)' when filtering is not needed. JavaScript based filtering
                                        // effectively limits precision of numeric values and it could trigger rendering
                                        // of values using scientific notation.
                                        if (exclusions !== '') {
                                            exclusions = new RegExp(exclusions);

                                            var stats = JSON.parse(value);

                                            Object.keys(stats).forEach(function(key) {
                                                var name = key.replace(/^[^.]*[.]/, '');
                                                if (exclusions.test(name)) {
                                                    delete stats[key];
                                                }
                                            });

                                            return JSON.stringify(stats);
                                        } else {
                                            return value;
                                        }
                                    {% if version == '5.0' %}
                                        </params>
                                    {% else %}
                                        </parameter></parameters>
                                    {% endif %}
                                </step>
                            </preprocessing>
                        {% endif %}
                    </item>
                {% endfor %}
            </items>

            {#-#############################################################-#}
            {#- DISCOVERY RULES -#}
            {#-#############################################################-#}

            <discovery_rules>
                {#-#########################################################-#}
                {#- ITEMS DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-1',
                        'name': 'Items discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","items"]',
                        'context': 'items',
                    },
                    [
                        {
                            'id': 'item-prototype-1.1',
                            'name': 'MEMORY.size (virtual size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.size"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.size\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.2',
                            'name': 'MEMORY.resident (resident size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.resident"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.resident\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.3',
                            'name': 'MEMORY.shared (shared size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.shared"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.shared\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.4',
                            'name': 'MEMORY.text (code size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.text"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.text\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.5',
                            'name': 'MEMORY.data (data + stack size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.data"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.data\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.6',
                            'name': 'MEMORY.swap (swapped size)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MEMORY.swap"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MEMORY.swap\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.7',
                            'name': 'PAGE_FAULTS.minor (minor page faults / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","PAGE_FAULTS.minor"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.PAGE_FAULTS.minor\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.8',
                            'name': 'PAGE_FAULTS.major (major page faults / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","PAGE_FAULTS.major"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.PAGE_FAULTS.major\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.9',
                            'name': 'MAIN.backend_busy (backend connections too many / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_busy"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_busy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.10',
                            'name': 'MAIN.backend_conn (backend connections successfully stablished / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_conn"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_conn\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.11',
                            'name': 'MAIN.backend_fail (backend connection failures / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_fail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_fail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.12',
                            'name': 'MAIN.backend_recycle (backend connection recycles / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_recycle"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_recycle\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.13',
                            'name': 'MAIN.backend_req (backend requests made / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_req"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_req\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.14',
                            'name': 'MAIN.backend_retry (backend connnections retry / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_retry"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_retry\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.15',
                            'name': 'MAIN.backend_reuse (backend connection reuses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_reuse"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_reuse\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.16',
                            'name': 'MAIN.backend_unhealthy (backend connections not attempted / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.backend_unhealthy"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.backend_unhealthy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.17',
                            'name': 'MAIN.bans (number of bans)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.bans"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.bans\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.18',
                            'name': 'MAIN.bans_lurker_obj_killed (objects killed by bans lurker / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.bans_lurker_obj_killed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.bans_lurker_obj_killed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.19',
                            'name': 'MAIN.bans_lurker_obj_killed_cutoff (objects killed by bans lurker for cutoff / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.bans_lurker_obj_killed_cutoff"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.bans_lurker_obj_killed_cutoff\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.20',
                            'name': 'MAIN.bans_obj_killed (objects killed by bans during lookup / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.bans_obj_killed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.bans_obj_killed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.21',
                            'name': 'MAIN.busy_killed (requests killed after sleep on busy objhdr / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.busy_killed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.busy_killed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.22',
                            'name': 'MAIN.busy_sleep (requests sent to sleep on busy objhdr / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.busy_sleep"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.busy_sleep\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.23',
                            'name': 'MAIN.busy_wakeup (requests woken after sleep on busy objhdr / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.busy_wakeup"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.busy_wakeup\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.24',
                            'name': 'MAIN.c_ykey_purges (YKey purge operations executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.c_ykey_purges"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.c_ykey_purges\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.25',
                            'name': 'MAIN.cache_hit (cache hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.cache_hit"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.cache_hit\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.26',
                            'name': 'MAIN.cache_hitmiss (cache hits for miss / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.cache_hitmiss"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.cache_hitmiss\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.27',
                            'name': 'MAIN.cache_hitpass (cache hits for pass / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.cache_hitpass"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.cache_hitpass\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.28',
                            'name': 'MAIN.cache_hit_grace (cache grace hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.cache_hit_grace"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.cache_hit_grace\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.29',
                            'name': 'MAIN.cache_miss (cache misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.cache_miss"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.cache_miss\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.30',
                            'name': 'MAIN.client_resp_500 (delivery failed due to insufficient workspace / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.client_resp_500"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.client_resp_500\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.31',
                            'name': 'MAIN.client_req (good -parseable- client requests received / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.client_req"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.client_req\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.32',
                            'name': 'MAIN.client_req_400 (client requests received, subject to 400 errors / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.client_req_400"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.client_req_400\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.33',
                            'name': 'MAIN.client_req_417 (client requests received, subject to 417 errors / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.client_req_417"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.client_req_417\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.34',
                            'name': 'MAIN.esi_errors (ESI parse errors -unlock- / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.esi_errors"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.esi_errors\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.35',
                            'name': 'MAIN.esi_maxdepth (ESI hit max_esi_depth / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.esi_maxdepth"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.esi_maxdepth\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.36',
                            'name': 'MAIN.esi_warnings (ESI parse warnings -unlock- / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.esi_warnings"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.esi_warnings\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.37',
                            'name': 'MAIN.fetch_1xx (beresps with no body because of 1xx responses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_1xx"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_1xx\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.38',
                            'name': 'MAIN.fetch_204 (beresps with no body because of 204 responses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_204"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_204\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.39',
                            'name': 'MAIN.fetch_304 (beresps with not body because of 304 responses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_304"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_304\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.40',
                            'name': 'MAIN.fetch_bad (bad fetches because beresp.body length/fetch could not be determined / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_bad"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_bad\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.41',
                            'name': 'MAIN.fetch_chunked (beresps with body chunked / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_chunked"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_chunked\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.42',
                            'name': 'MAIN.fetch_eof (beresps with body EOF / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_eof"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_eof\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.43',
                            'name': 'MAIN.fetch_failed (failed fetches -all causes- / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_failed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_failed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.44',
                            'name': 'MAIN.fetch_fast304 (fast 304 inserts / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_fast304"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_fast304\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.45',
                            'name': 'MAIN.fetch_head (beresps with not body because of HEAD requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_head"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_head\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.46',
                            'name': 'MAIN.fetch_length (beresps with body Content-Length / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_length"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_length\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.47',
                            'name': 'MAIN.fetch_none (beresps with no body / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_none"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_none\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.48',
                            'name': 'MAIN.fetch_no_thread (failed fetches because no thread available / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_no_thread"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_no_thread\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.49',
                            'name': 'MAIN.fetch_stale_deliver (stale deliveries / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_stale_deliver"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_stale_deliver\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.50',
                            'name': 'MAIN.fetch_stale_rearm (stale object rearmed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.fetch_stale_rearm"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.fetch_stale_rearm\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.51',
                            'name': 'MAIN.g_mem_file (RSS file usage)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.g_mem_file"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.g_mem_file\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.52',
                            'name': 'MAIN.g_mem_private (worker process private memory usage)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.g_mem_private"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.g_mem_private\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.53',
                            'name': 'MAIN.g_mem_rss (worker process RSS memory usage)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.g_mem_rss"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.g_mem_rss\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.54',
                            'name': 'MAIN.g_mem_swap (worker process swap usage)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.g_mem_swap"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.g_mem_swap\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.55',
                            'name': 'MAIN.goto_dns_cache_hits (cache hits within vmod_goto\'s DNS / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.goto_dns_cache_hits"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.goto_dns_cache_hits\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.56',
                            'name': 'MAIN.goto_dns_lookup_fails (number of unresolved DNS lookups from vmod_goto\'s DNS / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.goto_dns_lookup_fails"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.goto_dns_lookup_fails\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.57',
                            'name': 'MAIN.goto_dns_lookups (number of DNS lookups from vmod_goto\'s DNS / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.goto_dns_lookups"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.goto_dns_lookups\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.58',
                            'name': 'VMOD_HTTP.handle_requests (HTTP requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VMOD_HTTP.handle_requests"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VMOD_HTTP.handle_requests\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.59',
                            'name': 'VMOD_HTTP.handle_completed (completed HTTP requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VMOD_HTTP.handle_completed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VMOD_HTTP.handle_completed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.60',
                            'name': 'VMOD_HTTP.handle_abandon (abandoned HTTP requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VMOD_HTTP.handle_abandon"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VMOD_HTTP.handle_abandon\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.61',
                            'name': 'MAIN.losthdr (HTTP header overflows / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.losthdr"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.losthdr\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.62',
                            'name': 'MAIN.n_backend (number of backends)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_backend"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_backend\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.63',
                            'name': 'MAIN.n_vcl (number of loaded VCLs in total)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_vcl"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_vcl\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.64',
                            'name': 'MAIN.vmods (loaded VMODs)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.vmods"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.vmods\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.65',
                            'name': 'MAIN.n_expired (expired objects / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_expired"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_expired\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.66',
                            'name': 'MAIN.n_gunzip (gunzip operations / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_gunzip"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_gunzip\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.67',
                            'name': 'MAIN.n_gzip (gzip operations / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_gzip"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_gzip\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.68',
                            'name': 'MAIN.n_lru_limited (nuke_limit reachs / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_lru_limited"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_lru_limited\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.69',
                            'name': 'MAIN.n_lru_nuked (LRU nuked objects / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_lru_nuked"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_lru_nuked\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.70',
                            'name': 'MAIN.n_lru_moved (LRU moved objects / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_lru_moved"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_lru_moved\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.71',
                            'name': 'MAIN.n_object (object structs made)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_object"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_object\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.72',
                            'name': 'MAIN.n_objectcore (objectcore structs made)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_objectcore"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_objectcore\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.73',
                            'name': 'MAIN.n_objecthead (objecthead structs made)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_objecthead"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_objecthead\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.74',
                            'name': 'MAIN.n_obj_purged (purged objects / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_obj_purged"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_obj_purged\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.75',
                            'name': 'MAIN.n_purges (purge operations executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_purges"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_purges\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.76',
                            'name': 'MAIN.n_test_gunzip (test gunzip operations / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.n_test_gunzip"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.n_test_gunzip\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.77',
                            'name': 'MAIN.req_dropped (HTTP/2 stream refused / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.req_dropped"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.req_dropped\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.78',
                            'name': 'MAIN.sc_vcl_failure (session Err VCL_FAILURE / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sc_vcl_failure"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sc_vcl_failure\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.79',
                            'name': 'MAIN.sess_closed (sessions closed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_closed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_closed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.80',
                            'name': 'MAIN.sess_closed_err (sessions closed with error / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_closed_err"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_closed_err\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.81',
                            'name': 'MAIN.sess_conn (sessions successfully accepted / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_conn"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_conn\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.82',
                            'name': 'MAIN.sess_drop (sessions dropped due to lack of worker thread / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_drop"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_drop\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.83',
                            'name': 'MAIN.sess_dropped (sessions dropped because the queue was too long / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_dropped"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_dropped\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.84',
                            'name': 'MAIN.sess_fail (sessions TCP accept failures / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.85',
                            'name': 'MAIN.sess_fail_ebadf (session accept failures: bad file descriptor / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_ebadf"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_ebadf\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.86',
                            'name': 'MAIN.sess_fail_econnaborted (session accept failures: connection aborted / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_econnaborted"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_econnaborted\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.87',
                            'name': 'MAIN.sess_fail_eintr (session accept failures: interrupted system call / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_eintr"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_eintr\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.88',
                            'name': 'MAIN.sess_fail_emfile (session accept failures: too many open files / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_emfile"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_emfile\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.89',
                            'name': 'MAIN.sess_fail_enomem (session accept failures: not enough memory / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_enomem"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_enomem\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.90',
                            'name': 'MAIN.sess_fail_other (session accept failures: other / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_fail_other"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_fail_other\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.91',
                            'name': 'MAIN.sess_herd (sessions herd / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_herd"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_herd\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.92',
                            'name': 'MAIN.sess_queued (sessions queued waiting for a thread / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_queued"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_queued\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.93',
                            'name': 'MAIN.sess_readahead (sessions read ahead / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.sess_readahead"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.sess_readahead\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.94',
                            'name': 'MAIN.s_fetch (backend fetches initiated / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_fetch"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_fetch\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.95',
                            'name': 'MAIN.s_pass (passed requests seen / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_pass"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_pass\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.96',
                            'name': 'MAIN.s_pipe (pipe sessions seen / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_pipe"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_pipe\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.97',
                            'name': 'MAIN.s_pipe_hdrbytes (pipe request header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_pipe_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_pipe_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.98',
                            'name': 'MAIN.s_pipe_in (piped bytes from client / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_pipe_in"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_pipe_in\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.99',
                            'name': 'MAIN.s_pipe_out (piped bytes to client / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_pipe_out"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_pipe_out\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.100',
                            'name': 'MAIN.s_req (requests seen / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_req"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_req\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.101',
                            'name': 'MAIN.s_req_bodybytes (request body bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.102',
                            'name': 'MAIN.s_req_hdrbytes (request header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.103',
                            'name': 'MAIN.s_resp_bodybytes (response body bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.104',
                            'name': 'MAIN.s_resp_hdrbytes (response header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.105',
                            'name': 'MAIN.s_sess (sessions seen / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_sess"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_sess\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.106',
                            'name': 'MAIN.s_synth (synthetic responses made / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.s_synth"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.s_synth\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.107',
                            'name': 'MAIN.threads (number of threads in all pools)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.threads"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.threads\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.108',
                            'name': 'MAIN.threads_created (threads created in all pools / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.threads_created"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.threads_created\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.109',
                            'name': 'MAIN.threads_destroyed (threads destroyed in all pools / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.threads_destroyed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.threads_destroyed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.110',
                            'name': 'MAIN.threads_failed (failed thread creations / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.threads_failed"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.threads_failed\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.111',
                            'name': 'MAIN.threads_limited (times more threads were needed but limit was reached in a thread pool / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.threads_limited"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.threads_limited\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.112',
                            'name': 'MAIN.thread_queue_len (length of session queue waiting for threads)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.thread_queue_len"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.thread_queue_len\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.113',
                            'name': 'MAIN.uptime (child process uptime)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.uptime"]',
                            'value_type': 'UNSIGNED',
                            'units': 'uptime',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.uptime\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.114',
                            'name': 'MAIN.vcl_fail (VCL failures / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.vcl_fail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.vcl_fail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.115',
                            'name': 'MAIN.ws_backend_overflow (workspace_backend overflows / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.ws_backend_overflow"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.ws_backend_overflow\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.116',
                            'name': 'MAIN.ws_client_overflow (workspace_client overflows / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.ws_client_overflow"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.ws_client_overflow\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.117',
                            'name': 'MAIN.ws_session_overflow (workspace_session overflows / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.ws_session_overflow"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.ws_session_overflow\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.118',
                            'name': 'MAIN.ws_thread_overflow (workspace_thread overflows / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.ws_thread_overflow"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.ws_thread_overflow\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.119',
                            'name': 'MGT.uptime (management process uptime)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MGT.uptime"]',
                            'value_type': 'UNSIGNED',
                            'units': 'uptime',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MGT.uptime\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.120',
                            'name': 'cache_hit_ratio',
                            'type': 'CALCULATED',
                            'key': 'varnish["{#LOCATION_ID}","cache_hit_ratio"]',
                            'value_type': 'FLOAT',
                            'units': '%',
                            'delay': true,
                            'params':
                                '100*last("varnish.stat[\\"{#LOCATION_ID}\\",\\"MAIN.cache_hit\\"]")/(last("varnish.stat[\\"{#LOCATION_ID}\\",\\"MAIN.cache_hit\\"]")+last("varnish.stat[\\"{#LOCATION_ID}\\",\\"MAIN.cache_miss\\"]")+(count("varnish.stat[\\"{#LOCATION_ID}\\",\\"MAIN.cache_hit\\"]",#1,0)*count("varnish.stat[\\"{#LOCATION_ID}\\",\\"MAIN.cache_miss\\"]",#1,0)))'
                                if version in ('5.0', '5.2') else
                                '100*last(//varnish.stat["{#LOCATION_ID}","MAIN.cache_hit"])/(last(//varnish.stat["{#LOCATION_ID}","MAIN.cache_hit"])+last(//varnish.stat["{#LOCATION_ID}","MAIN.cache_miss"])+(count(//varnish.stat["{#LOCATION_ID}","MAIN.cache_hit"],#1,"eq",0)*count(//varnish.stat["{#LOCATION_ID}","MAIN.cache_miss"],#1,"eq",0)))',
                        },
                        {
                            'id': 'item-prototype-1.121',
                            'name': 'VHA6.broadcast_candidates (broadcast candidates / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcast_candidates"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcast_candidates\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.122',
                            'name': 'VHA6.broadcast_nocache (skipped broadcasts: uncacheable / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcast_nocache"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcast_nocache\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.123',
                            'name': 'VHA6.broadcast_skip (skipped broadcasts: skip / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcast_skip"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcast_skip\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.124',
                            'name': 'VHA6.broadcast_lowttl (skipped broadcasts: low TTL or grace / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcast_lowttl"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcast_lowttl\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.125',
                            'name': 'VHA6.broadcast_toolarge (skipped broadcasts: too large / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcast_toolarge"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcast_toolarge\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.126',
                            'name': 'VHA6.broadcasts (executed broadcasts / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.broadcasts"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.broadcasts\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.127',
                            'name': 'VHA6.fetch_self (self replication notifications / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_self"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_self\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.128',
                            'name': 'VHA6.fetch_peer (peer replication notifications / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_peer"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_peer\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.129',
                            'name': 'VHA6.fetch_peer_hit (broadcasts which cache hit on the peer node / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_peer_hit"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_peer_hit\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.130',
                            'name': 'VHA6.fetch_origin (replication requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_origin"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_origin\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.131',
                            'name': 'VHA6.fetch_origin_deliver (replication responses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_origin_deliver"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_origin_deliver\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.132',
                            'name': 'VHA6.fetch_peer_insert (replication insertions / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.fetch_peer_insert"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.fetch_peer_insert\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.133',
                            'name': 'VHA6.error_version_mismatch',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_version_mismatch"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_version_mismatch\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.134',
                            'name': 'VHA6.error_no_token',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_no_token"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_no_token\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.135',
                            'name': 'VHA6.error_bad_token',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_bad_token"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_bad_token\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.136',
                            'name': 'VHA6.error_stale_token',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_stale_token"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_stale_token\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.137',
                            'name': 'VHA6.error_rate_limited',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_rate_limited"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_rate_limited\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.138',
                            'name': 'VHA6.error_fetch',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_fetch"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_fetch\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.139',
                            'name': 'VHA6.error_fetch_insert',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_fetch_insert"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_fetch_insert\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.140',
                            'name': 'VHA6.error_fetch_seal',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_fetch_seal"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_fetch_seal\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.141',
                            'name': 'VHA6.error_localhost',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_localhost"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_localhost\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.142',
                            'name': 'VHA6.error_origin_mismatch',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_origin_mismatch"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_origin_mismatch\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.143',
                            'name': 'VHA6.error_origin_miss',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VHA6.error_origin_miss"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VHA6.error_origin_miss\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.144',
                            'name': 'ACCG_DIAG.set_key_failure (failed attempts to set key for any reason / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.set_key_failure"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.set_key_failure\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.145',
                            'name': 'ACCG_DIAG.out_of_key_slots (failed attempts to set key due to no key slots / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.out_of_key_slots"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.out_of_key_slots\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.146',
                            'name': 'ACCG_DIAG.key_without_namespace (failed attempts to set key due to no namespace / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.key_without_namespace"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.key_without_namespace\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.147',
                            'name': 'ACCG_DIAG.namespace_already_set (attempts to escape namespace / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.namespace_already_set"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.namespace_already_set\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.148',
                            'name': 'ACCG_DIAG.namespace_undefined (failed to set namespace due to not created / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.namespace_undefined"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.namespace_undefined\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.149',
                            'name': 'ACCG_DIAG.create_namespace_failure (failed attempts to create namespace for any reason / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG_DIAG.create_namespace_failure"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG_DIAG.create_namespace_failure\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-1.150',
                            'name': 'MAIN.esi_req (ESI subrequests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MAIN.esi_req"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MAIN.esi_req\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                    ],
                    [
                        {
                            'id': 'trigger-prototype-1.1',
                            'name': 'Varnish Cache[{#LOCATION}] has been restarted',
                            'expression':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.uptime"].last()}'
                                '<{$VARNISH_CACHE.MAIN_UPTIME.MIN:"{#LOCATION_ID}"} or'
                                ' {Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MGT.uptime"].last()}'
                                '<{$VARNISH_CACHE.MGT_UPTIME.MIN:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.uptime"])'
                                '<{$VARNISH_CACHE.MAIN_UPTIME.MIN:"{#LOCATION_ID}"} or'
                                ' last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MGT.uptime"])'
                                '<{$VARNISH_CACHE.MGT_UPTIME.MIN:"{#LOCATION_ID}"}',
                            'priority': 'HIGH',
                        },
                        {
                            'id': 'trigger-prototype-1.2',
                            'name': 'Varnish Cache[{#LOCATION}] has surpassed {$VARNISH_CACHE.THREADS.MAX} threads',
                            'expression':
                                '{$VARNISH_CACHE.THREADS.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.threads"].last()}'
                                '>{$VARNISH_CACHE.THREADS.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.THREADS.ENABLED:"{#LOCATION_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.threads"])'
                                '>{$VARNISH_CACHE.THREADS.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.3',
                            'name': 'Varnish Cache[{#LOCATION}] is generating HTTP header overflows',
                            'expression':
                                '{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.losthdr"].last()}'
                                '>{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.losthdr"])'
                                '>{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.4',
                            'name': 'Varnish Cache[{#LOCATION}] is generating VCL failures',
                            'expression':
                                '{$VARNISH_CACHE.VCL_FAILURES_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.vcl_fail"].last()}'
                                '>{$VARNISH_CACHE.VCL_FAILURES_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.VCL_FAILURES_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.vcl_fail"])'
                                '>{$VARNISH_CACHE.VCL_FAILURES_RATE.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.5',
                            'name': 'Varnish Cache[{#LOCATION}] is generating workspace overflows',
                            'expression':
                                '{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '({Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.client_resp_500"].last()}'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' {Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.ws_backend_overflow"].last()}'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' {Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.ws_client_overflow"].last()}'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' {Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.ws_session_overflow"].last()}'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' {Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.ws_thread_overflow"].last()}'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"})'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '(last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.client_resp_500"])'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.ws_backend_overflow"])'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.ws_client_overflow"])'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.ws_session_overflow"])'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"} or'
                                ' last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.ws_thread_overflow"])'
                                '>{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX:"{#LOCATION_ID}"})',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.6',
                            'name': 'Varnish Cache[{#LOCATION}] is getting backend connection failures',
                            'expression':
                                '{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.backend_fail"].min({$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.SAMPLES:"{#LOCATION_ID}"})}'
                                '>{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                'min(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.backend_fail"],{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.SAMPLES:"{#LOCATION_ID}"})'
                                '>{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.7',
                            'name': 'Varnish Cache[{#LOCATION}] is nuking objects',
                            'expression':
                                '{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.n_lru_nuked"].last()}'
                                '>{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.n_lru_nuked"])'
                                '>{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.MAX:"{#LOCATION_ID}"}',
                            'recovery':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.n_lru_nuked"].max({$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}"})}'
                                '<={$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                'max(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.n_lru_nuked"],{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}"})'
                                '<={$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                        {
                            'id': 'trigger-prototype-1.8',
                            'name': 'Varnish Cache[{#LOCATION}] is reaching nuke_limit',
                            'expression':
                                '{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.n_lru_limited"].last()}'
                                '>{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.ENABLED:"{#LOCATION_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.n_lru_limited"])'
                                '>{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.MAX:"{#LOCATION_ID}"}',
                            'recovery':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MAIN.n_lru_limited"].max({$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}"})}'
                                '<={$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.MAX:"{#LOCATION_ID}"}'
                                if version in ('5.0', '5.2') else
                                'max(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MAIN.n_lru_limited"],{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}"})'
                                '<={$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.MAX:"{#LOCATION_ID}"}',
                            'priority': 'WARNING',
                        },
                    ]) }}

                {#-#########################################################-#}
                {#- BACKENDS DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-2',
                        'name': 'Backends discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","backends"]',
                        'context': 'backends',
                    },
                    [
                        {
                            'id': 'item-prototype-2.1',
                            'name': 'VBE.{#SUBJECT}.healthy',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.healthy"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.healthy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.2',
                            'name': 'VBE.{#SUBJECT}.bereq_bodybytes (request body bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.bereq_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.bereq_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.3',
                            'name': 'VBE.{#SUBJECT}.bereq_hdrbytes (request header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.bereq_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.bereq_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.4',
                            'name': 'VBE.{#SUBJECT}.beresp_bodybytes (response body bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.beresp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.beresp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.5',
                            'name': 'VBE.{#SUBJECT}.beresp_hdrbytes (response header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.beresp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.beresp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.6',
                            'name': 'VBE.{#SUBJECT}.busy (fetches not attempted due to backend being busy / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.busy"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.busy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.7',
                            'name': 'VBE.{#SUBJECT}.conn (connections to backend)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.conn"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.conn\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.8',
                            'name': 'VBE.{#SUBJECT}.fail (connections failed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.9',
                            'name': 'VBE.{#SUBJECT}.fail_eacces (connections failed with EACCES or EPERM / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_eacces"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_eacces\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.10',
                            'name': 'VBE.{#SUBJECT}.fail_eaddrnotavail (connections failed with EADDRNOTAVAIL / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_eaddrnotavail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_eaddrnotavail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.11',
                            'name': 'VBE.{#SUBJECT}.fail_econnrefused (connections failed with ECONNREFUSED / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_econnrefused"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_econnrefused\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.12',
                            'name': 'VBE.{#SUBJECT}.fail_enetunreach (connections failed with ENETUNREACH / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_enetunreach"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_enetunreach\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.13',
                            'name': 'VBE.{#SUBJECT}.fail_etimedout (connections failed with ETIMEDOUT / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_etimedout"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_etimedout\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.14',
                            'name': 'VBE.{#SUBJECT}.fail_other (connections failed for other reason / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.fail_other"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.fail_other\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.15',
                            'name': 'VBE.{#SUBJECT}.happy (happy health probe)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.happy"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.happy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.16',
                            'name': 'VBE.{#SUBJECT}.helddown (connection opens not attempted / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.helddown"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.helddown\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.17',
                            'name': 'VBE.{#SUBJECT}.pipe_hdrbytes (pipe request header bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.pipe_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.pipe_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.18',
                            'name': 'VBE.{#SUBJECT}.pipe_in (piped bytes from backend / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.pipe_in"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.pipe_in\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.19',
                            'name': 'VBE.{#SUBJECT}.pipe_out (piped bytes to backend / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.pipe_out"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.pipe_out\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.20',
                            'name': 'VBE.{#SUBJECT}.req (backend requests sent / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.req"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.req\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.21',
                            'name': 'VBE.{#SUBJECT}.unhealthy (fetches not attempted due to backend being unhealthy / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.unhealthy"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.VBE.{#SUBJECT_ID}.unhealthy\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-2.22',
                            'name': 'VBE.{#SUBJECT}.last_happy',
                            'type': 'CALCULATED',
                            'key': 'varnish["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.last_happy"]',
                            'value_type': 'UNSIGNED',
                            'delay': true,
                            'params':
                                'band("varnish.stat[\\"{#LOCATION_ID}\\",\\"VBE.{#SUBJECT_ID}.happy\\"]",#1,1)'
                                if version in ('5.0', '5.2') else
                                'bitand(last(//varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.happy"]),1)',
                        },
                    ],
                    [
                        {
                            'id': 'trigger-prototype-2.1',
                            'name': 'Varnish Cache[{#LOCATION}] {#SUBJECT} backend is sick',
                            'expression':
                                '{$VARNISH_CACHE.BACKEND_HEALTHINESS.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.healthy"].max({$VARNISH_CACHE.BACKEND_HEALTHINESS.SAMPLES:"{#LOCATION_ID}:{#SUBJECT_ID}"})}<1'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.BACKEND_HEALTHINESS.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                'max(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","VBE.{#SUBJECT_ID}.healthy"],{$VARNISH_CACHE.BACKEND_HEALTHINESS.SAMPLES:"{#LOCATION_ID}:{#SUBJECT_ID}"})<1',
                            'priority': 'HIGH',
                        },
                    ]) }}

                {#-#########################################################-#}
                {#- STORAGES DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-3',
                        'name': 'Storages discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","storages"]',
                        'context': 'storages',
                    },
                    [
                        {
                            'id': 'item-prototype-3.1',
                            'name': 'STG.{#SUBJECT}.c_fail (allocator failures / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_fail"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.c_fail\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.2',
                            'name': 'STG.{#SUBJECT}.c_memcache_hit (stored objects cache hits bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_hit"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.c_memcache_hit\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.3',
                            'name': 'STG.{#SUBJECT}.c_memcache_miss (stored objects cache misses bytes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_miss"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.c_memcache_miss\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.4',
                            'name': 'STG.{#SUBJECT}.c_ykey_purged (number of objects purged with YKey / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_ykey_purged"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.c_ykey_purged\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.5',
                            'name': 'STG.{#SUBJECT}.g_bytes (bytes outstanding)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_bytes"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.g_bytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.6',
                            'name': 'STG.{#SUBJECT}.g_space (bytes available)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_space"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.g_space\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.7',
                            'name': 'STG.{#SUBJECT}.g_sparenode (spare nodes available)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_sparenode"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.g_sparenode\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.8',
                            'name': 'STG.{#SUBJECT}.g_ykey_keys (number of YKeys registered)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_ykey_keys"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.g_ykey_keys\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.9',
                            'name': 'STG.{#SUBJECT}.n_lru_moved (number of LRU move operations / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.n_lru_moved"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.n_lru_moved\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.10',
                            'name': 'STG.{#SUBJECT}.n_lru_nuked (number of LRU nuked objects / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.n_lru_nuked"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.n_lru_nuked\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.11',
                            'name': 'STG.{#SUBJECT}.n_vary (number of Vary header keys / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.n_vary"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.STG.{#SUBJECT_ID}.n_vary\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-3.12',
                            'name': 'STG.{#SUBJECT}.cache_hit_ratio',
                            'type': 'CALCULATED',
                            'key': 'varnish["{#LOCATION_ID}","STG.{#SUBJECT_ID}.cache_hit_ratio"]',
                            'value_type': 'FLOAT',
                            'units': '%',
                            'delay': true,
                            'params':
                                '100*last("varnish.stat[\\"{#LOCATION_ID}\\",\\"STG.{#SUBJECT_ID}.c_memcache_hit\\"]")/(last("varnish.stat[\\"{#LOCATION_ID}\\",\\"STG.{#SUBJECT_ID}.c_memcache_hit\\"]")+last("varnish.stat[\\"{#LOCATION_ID}\\",\\"STG.{#SUBJECT_ID}.c_memcache_miss\\"]")+(count("varnish.stat[\\"{#LOCATION_ID}\\",\\"STG.{#SUBJECT_ID}.c_memcache_hit\\"]",#1,0)*count("varnish.stat[\\"{#LOCATION_ID}\\",\\"STG.{#SUBJECT_ID}.c_memcache_miss\\"]",#1,0)))'
                                if version in ('5.0', '5.2') else
                                '100*last(//varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_hit"])/(last(//varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_hit"])+last(//varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_miss"])+(count(//varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_hit"],#1,"eq",0)*count(//varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_memcache_miss"],#1,"eq",0)))',
                        },
                    ],
                    [
                        {
                            'id': 'trigger-prototype-3.1',
                            'name': 'Varnish Cache[{#LOCATION}] {#SUBJECT} storage failed to allocate space',
                            'expression':
                                '{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_fail"].last()}'
                                '>{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.MAX:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_fail"])'
                                '>{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.MAX:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'recovery':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_fail"].max({$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}:{#SUBJECT_ID}"})}'
                                '<={$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.MAX:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                'max(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.c_fail"],{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.RECOVERY.SAMPLES:"{#LOCATION_ID}:{#SUBJECT_ID}"})'
                                '<={$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.MAX:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'priority': 'HIGH',
                        },
                        {
                            'id': 'trigger-prototype-3.2',
                            'name': 'Varnish Cache[{#LOCATION}] {#SUBJECT} storage is running out of spare nodes',
                            'expression':
                                '{$VARNISH_CACHE.SPARE_NODES.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_sparenode"].last()}'
                                '<{$VARNISH_CACHE.SPARE_NODES.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.SPARE_NODES.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_sparenode"])'
                                '<{$VARNISH_CACHE.SPARE_NODES.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'recovery':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_sparenode"].last()}'
                                '>{$VARNISH_CACHE.SPARE_NODES.RECOVERY.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","STG.{#SUBJECT_ID}.g_sparenode"])'
                                '>{$VARNISH_CACHE.SPARE_NODES.RECOVERY.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'priority': 'WARNING',
                        },
                    ]) }}

                {#-#########################################################-#}
                {#- MSE BOOKS DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-4',
                        'name': 'MSE books discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","mse_books"]',
                        'context': 'mse_books',
                    },
                    [
                        {
                            'id': 'item-prototype-4.1',
                            'name': 'MSE_BOOK.{#SUBJECT}.c_insert_timeout (number of times database object insertion timed out / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.c_insert_timeout"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.c_insert_timeout\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.2',
                            'name': 'MSE_BOOK.{#SUBJECT}.c_waterlevel_purge (number of objects purged to achieve database waterlevel / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_purge"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_purge\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.3',
                            'name': 'MSE_BOOK.{#SUBJECT}.c_waterlevel_queue (number of times a thread has been queued waiting for database space / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_queue"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_queue\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.4',
                            'name': 'MSE_BOOK.{#SUBJECT}.c_waterlevel_runs (number of times the waterlevel purge thread was activated / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_runs"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.c_waterlevel_runs\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.5',
                            'name': 'MSE_BOOK.{#SUBJECT}.g_banlist_bytes (number of bytes used from the banlist journal file)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_banlist_bytes"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.g_banlist_bytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.6',
                            'name': 'MSE_BOOK.{#SUBJECT}.g_banlist_space (number of bytes available in the banlist journal file)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_banlist_space"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.g_banlist_space\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.7',
                            'name': 'MSE_BOOK.{#SUBJECT}.g_bytes (number of bytes used in the book database)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_bytes"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.g_bytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.8',
                            'name': 'MSE_BOOK.{#SUBJECT}.g_space (number of bytes available in the book database)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_space"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.g_space\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-4.9',
                            'name': 'MSE_BOOK.{#SUBJECT}.n_vary (number of Vary header keys / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.n_vary"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_BOOK.{#SUBJECT_ID}.n_vary\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                    ],
                    [
                        {
                            'id': 'trigger-prototype-4.1',
                            'name': 'Varnish Cache[{#LOCATION}] {#SUBJECT} MSE book is running out of space',
                            'expression':
                                '{$VARNISH_CACHE.MSE_BOOK_SPACE.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_space"].last()}'
                                '<{$VARNISH_CACHE.MSE_BOOK_SPACE.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                '{$VARNISH_CACHE.MSE_BOOK_SPACE.ENABLED:"{#LOCATION_ID}:{#SUBJECT_ID}"} and '
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_space"])'
                                '<{$VARNISH_CACHE.MSE_BOOK_SPACE.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'recovery':
                                '{Template App ' + name + ':varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_space"].last()}'
                                '>{$VARNISH_CACHE.MSE_BOOK_SPACE.RECOVERY.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}'
                                if version in ('5.0', '5.2') else
                                'last(/Template App ' + name + '/varnish.stat["{#LOCATION_ID}","MSE_BOOK.{#SUBJECT_ID}.g_space"])'
                                '>{$VARNISH_CACHE.MSE_BOOK_SPACE.RECOVERY.MIN:"{#LOCATION_ID}:{#SUBJECT_ID}"}',
                            'priority': 'WARNING',
                        },
                    ]) }}

                {#-#########################################################-#}
                {#- MSE STORES DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-5',
                        'name': 'MSE stores discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","mse_stores"]',
                        'context': 'mse_stores',
                    },
                    [
                        {
                            'id': 'item-prototype-5.1',
                            'name': 'MSE_STORE.{#SUBJECT}.c_aio_finished_bytes_read (number AIO read bytes executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_aio_finished_bytes_read"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_aio_finished_bytes_read\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.2',
                            'name': 'MSE_STORE.{#SUBJECT}.c_aio_finished_bytes_write (number AIO write bytes executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_aio_finished_bytes_write"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_aio_finished_bytes_write\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.3',
                            'name': 'MSE_STORE.{#SUBJECT}.c_aio_finished_read (number AIO read operations executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_aio_finished_read"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_aio_finished_read\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.4',
                            'name': 'MSE_STORE.{#SUBJECT}.c_aio_finished_write (number AIO write operations executed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_aio_finished_write"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_aio_finished_write\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.5',
                            'name': 'MSE_STORE.{#SUBJECT}.c_waterlevel_purge (number of objects purged to achieve store waterlevel / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_waterlevel_purge"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_waterlevel_purge\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.6',
                            'name': 'MSE_STORE.{#SUBJECT}.c_waterlevel_queue (number of times a thread has been queued waiting for store space / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.c_waterlevel_queue"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.c_waterlevel_queue\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.7',
                            'name': 'MSE_STORE.{#SUBJECT}.g_alloc_bytes (total number of bytes in allocation extents)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.g_alloc_bytes"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.g_alloc_bytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.8',
                            'name': 'MSE_STORE.{#SUBJECT}.g_free_bytes (total number of bytes in free extents)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.g_free_bytes"]',
                            'value_type': 'UNSIGNED',
                            'units': 'B',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.g_free_bytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.9',
                            'name': 'MSE_STORE.{#SUBJECT}.g_objects (number of objects in the store)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.g_objects"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.g_objects\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-5.10',
                            'name': 'MSE_STORE.{#SUBJECT}.g_ykey_keys (number of YKeys registered in the store)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","MSE_STORE.{#SUBJECT_ID}.g_ykey_keys"]',
                            'value_type': 'UNSIGNED',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.MSE_STORE.{#SUBJECT_ID}.g_ykey_keys\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                            ],
                        },
                    ],
                    [
                    ]) }}

                {#-#########################################################-#}
                {#- COUNTERS DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-6',
                        'name': 'Counters discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","counters"]',
                        'context': 'counters',
                    },
                    [
                        {
                            'id': 'item-prototype-6.1',
                            'name': 'COUNTER.{#SUBJECT} (counter value / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","COUNTER.{#SUBJECT_ID}"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.COUNTER.{#SUBJECT_ID}\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                    ],
                    [
                    ]) }}

                {#-#########################################################-#}
                {#- ACCOUNTINGS DISCOVERY -#}
                {#-#########################################################-#}

                {{ discovery_rule(
                    {
                        'id': 'discovery-rule-7',
                        'name': 'Accountings discovery',
                        'key': 'varnish.discovery["{$VARNISH_CACHE.LOCATIONS}","accountings"]',
                        'context': 'accountings',
                    },
                    [
                        {
                            'id': 'item-prototype-7.1',
                            'name': 'ACCG.{#SUBJECT}.client_req_count (total number of client requests processed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_req_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_req_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.2',
                            'name': 'ACCG.{#SUBJECT}.client_200_count (number of 200 responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_200_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_200_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.3',
                            'name': 'ACCG.{#SUBJECT}.client_304_count (number of 304 responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_304_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_304_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.4',
                            'name': 'ACCG.{#SUBJECT}.client_404_count (number of 404 responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_404_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_404_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.5',
                            'name': 'ACCG.{#SUBJECT}.client_503_count (number of 503 responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_503_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_503_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.6',
                            'name': 'ACCG.{#SUBJECT}.client_2xx_count (number of 2xx responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_2xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_2xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.7',
                            'name': 'ACCG.{#SUBJECT}.client_3xx_count (number of 3xx responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_3xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_3xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.8',
                            'name': 'ACCG.{#SUBJECT}.client_4xx_count (number of 4xx responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_4xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_4xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.9',
                            'name': 'ACCG.{#SUBJECT}.client_5xx_count (number of 5xx responses for client requests / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_5xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_5xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.10',
                            'name': 'ACCG.{#SUBJECT}.client_req_hdrbytes (client request header bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.11',
                            'name': 'ACCG.{#SUBJECT}.client_req_bodybytes (client request body bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.12',
                            'name': 'ACCG.{#SUBJECT}.client_resp_hdrbytes (client response header bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.13',
                            'name': 'ACCG.{#SUBJECT}.client_resp_bodybytes (client response body bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.14',
                            'name': 'ACCG.{#SUBJECT}.client_hit_count (number of client request hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_hit_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_hit_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.15',
                            'name': 'ACCG.{#SUBJECT}.client_hit_req_hdrbytes (client request header bytes for hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_hit_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_hit_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.16',
                            'name': 'ACCG.{#SUBJECT}.client_hit_req_bodybytes (client request body bytes for hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_hit_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_hit_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.17',
                            'name': 'ACCG.{#SUBJECT}.client_hit_resp_hdrbytes (client response header bytes for hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_hit_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_hit_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.18',
                            'name': 'ACCG.{#SUBJECT}.client_hit_resp_bodybytes (client response body bytes for hits / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_hit_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_hit_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.19',
                            'name': 'ACCG.{#SUBJECT}.client_miss_count (number of client request misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_miss_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_miss_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.20',
                            'name': 'ACCG.{#SUBJECT}.client_miss_req_hdrbytes (client request header bytes for misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_miss_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_miss_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.21',
                            'name': 'ACCG.{#SUBJECT}.client_miss_req_bodybytes (client request body bytes for misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_miss_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_miss_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.22',
                            'name': 'ACCG.{#SUBJECT}.client_miss_resp_hdrbytes (client response header bytes for misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_miss_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_miss_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.23',
                            'name': 'ACCG.{#SUBJECT}.client_miss_resp_bodybytes (client response body bytes for misses / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_miss_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_miss_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.24',
                            'name': 'ACCG.{#SUBJECT}.client_pass_count (number of client request passes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pass_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pass_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.25',
                            'name': 'ACCG.{#SUBJECT}.client_pass_req_hdrbytes (client request header bytes for passes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pass_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pass_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.26',
                            'name': 'ACCG.{#SUBJECT}.client_pass_req_bodybytes (client request body bytes for passes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pass_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pass_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.27',
                            'name': 'ACCG.{#SUBJECT}.client_pass_resp_hdrbytes (client response header bytes for passes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pass_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pass_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.28',
                            'name': 'ACCG.{#SUBJECT}.client_pass_resp_bodybytes (client response body bytes for passes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pass_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pass_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.29',
                            'name': 'ACCG.{#SUBJECT}.client_synth_count (number of client request synths / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_synth_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_synth_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.30',
                            'name': 'ACCG.{#SUBJECT}.client_synth_req_hdrbytes (client request header bytes for synths / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_synth_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_synth_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.31',
                            'name': 'ACCG.{#SUBJECT}.client_synth_req_bodybytes (client request body bytes for synths / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_synth_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_synth_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.32',
                            'name': 'ACCG.{#SUBJECT}.client_synth_resp_hdrbytes (client response header bytes for synths / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_synth_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_synth_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.33',
                            'name': 'ACCG.{#SUBJECT}.client_synth_resp_bodybytes (client response body bytes for synths / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_synth_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_synth_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.34',
                            'name': 'ACCG.{#SUBJECT}.client_pipe_count (number of client request pipes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pipe_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pipe_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.35',
                            'name': 'ACCG.{#SUBJECT}.client_pipe_req_hdrbytes (client request header bytes for pipes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pipe_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pipe_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.36',
                            'name': 'ACCG.{#SUBJECT}.client_pipe_req_bodybytes (client request body bytes for pipes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pipe_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pipe_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.37',
                            'name': 'ACCG.{#SUBJECT}.client_pipe_resp_hdrbytes (client response header bytes for pipes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pipe_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pipe_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.38',
                            'name': 'ACCG.{#SUBJECT}.client_pipe_resp_bodybytes (client response body bytes for pipes / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_pipe_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_pipe_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.39',
                            'name': 'ACCG.{#SUBJECT}.backend_req_count (total number of backend requests processed / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_req_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_req_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.40',
                            'name': 'ACCG.{#SUBJECT}.backend_200_count (number of backend responses of type 200 / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_200_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_200_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.41',
                            'name': 'ACCG.{#SUBJECT}.backend_304_count (number of backend responses of type 304 / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_304_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_304_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.42',
                            'name': 'ACCG.{#SUBJECT}.backend_404_count (number of backend responses of type 404 / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_404_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_404_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.43',
                            'name': 'ACCG.{#SUBJECT}.backend_503_count (number of backend responses of type 503 / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_503_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_503_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.44',
                            'name': 'ACCG.{#SUBJECT}.backend_2xx_count (number of backend responses of type 2xx / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_2xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_2xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.45',
                            'name': 'ACCG.{#SUBJECT}.backend_3xx_count (number of backend responses of type 3xx / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_3xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_3xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.46',
                            'name': 'ACCG.{#SUBJECT}.backend_4xx_count (number of backend responses of type 4xx / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_4xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_4xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.47',
                            'name': 'ACCG.{#SUBJECT}.backend_5xx_count (number of backend responses of type 5xx / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_5xx_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_5xx_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.48',
                            'name': 'ACCG.{#SUBJECT}.backend_req_hdrbytes (backend request header bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_req_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_req_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.49',
                            'name': 'ACCG.{#SUBJECT}.backend_req_bodybytes (backend request body bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_req_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_req_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.50',
                            'name': 'ACCG.{#SUBJECT}.backend_resp_hdrbytes (backend response header bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_resp_hdrbytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_resp_hdrbytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.51',
                            'name': 'ACCG.{#SUBJECT}.backend_resp_bodybytes (backend response body bytes total / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.backend_resp_bodybytes"]',
                            'value_type': 'FLOAT',
                            'units': 'Bps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.backend_resp_bodybytes\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                        {
                            'id': 'item-prototype-7.52',
                            'name': 'ACCG.{#SUBJECT}.cache_hit_ratio',
                            'type': 'CALCULATED',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.cache_hit_ratio"]',
                            'value_type': 'FLOAT',
                            'units': '%',
                            'delay': true,
                            'params':
                                '100*last("varnish.stat[\\"{#LOCATION_ID}\\",\\"ACCG.{#SUBJECT}.client_hit_count\\"]")/(last("varnish.stat[\\"{#LOCATION_ID}\\",\\"ACCG.{#SUBJECT}.client_hit_count\\"]")+last("varnish.stat[\\"{#LOCATION_ID}\\",\\"ACCG.{#SUBJECT}.client_miss_count\\"]")+(count("varnish.stat[\\"{#LOCATION_ID}\\",\\"ACCG.{#SUBJECT}.client_hit_count\\"]",#1,0)*count("varnish.stat[\\"{#LOCATION_ID}\\",\\"ACCG.{#SUBJECT}.client_miss_count\\"]",#1,0)))'
                                if version in ('5.0', '5.2') else
                                '100*last(//varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.client_hit_count"])/(last(//varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.client_hit_count"])+last(//varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.client_miss_count"])+(count(//varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.client_hit_count"],#1,"eq",0)*count(//varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT}.client_miss_count"],#1,"eq",0)))',
                        },
                        {
                            'id': 'item-prototype-7.53',
                            'name': 'ACCG.{#SUBJECT}.client_grace_hit_count (number of cache hits with grace / sec)',
                            'type': 'DEPENDENT',
                            'key': 'varnish.stat["{#LOCATION_ID}","ACCG.{#SUBJECT_ID}.client_grace_hit_count"]',
                            'value_type': 'FLOAT',
                            'units': 'eps',
                            'master_item_key': master,
                            'preprocessing': [
                                {
                                    'type': 'JSONPATH',
                                    'params': '$[\'{#LOCATION_ID}.ACCG.{#SUBJECT_ID}.client_grace_hit_count\']',
                                    'error_handler': 'DISCARD_VALUE',
                                },
                                {
                                    'type': 'CHANGE_PER_SECOND',
                                },
                            ],
                        },
                    ],
                    [
                    ]) }}
            </discovery_rules>

            {#-#############################################################-#}
            {#- TAGS -#}
            {#-#############################################################-#}

            <tags>
                <tag>
                    <tag>Application</tag>
                    <value>Varnish Cache</value>
                </tag>
            </tags>

            {#-#############################################################-#}
            {#- MACROS -#}
            {#-#############################################################-#}

            <macros>
                {% for macro in [
                        ('{$VARNISH_CACHE.LOCATIONS}', ''),
                        ('{$VARNISH_CACHE.EXCLUDED_STATS}', ''),
                        ('{$VARNISH_CACHE.PROC_MEM.VARNISHD.NAME}', 'varnishd'),

                        ('{$VARNISH_CACHE.AGENT_PROCESSES.MIN}', '1'),
                        ('{$VARNISH_CACHE.BROADCASTER_PROCESSES.MIN}', '1'),
                        ('{$VARNISH_CACHE.NCSA_PROCESSES.MIN}', '1'),
                        ('{$VARNISH_CACHE.VARNISH_PROCESSES.MIN}', '2'),
                        ('{$VARNISH_CACHE.RAW_LOG_PROCESSES.MIN}', '1'),
                        ('{$VARNISH_CACHE.VCS_AGENT_PROCESSES.MIN}', '1'),

                        ('{$VARNISH_CACHE.LLD_EXCLUDED_SUBJECTS:accountings}', '^(?!std[.])'),
                        ('{$VARNISH_CACHE.LLD_EXCLUDED_SUBJECTS}', '^(?!)'),
                        ('{$VARNISH_CACHE.LLD_KEEP_LOST_RESOURCES_PERIOD:backends}', '1d'),
                        ('{$VARNISH_CACHE.LLD_KEEP_LOST_RESOURCES_PERIOD:counters}', '1d'),
                        ('{$VARNISH_CACHE.LLD_KEEP_LOST_RESOURCES_PERIOD:accountings}', '1d'),
                        ('{$VARNISH_CACHE.LLD_KEEP_LOST_RESOURCES_PERIOD}', '30d'),
                        ('{$VARNISH_CACHE.LLD_UPDATE_INTERVAL:counters}', '60s'),
                        ('{$VARNISH_CACHE.LLD_UPDATE_INTERVAL:accountings}', '60s'),
                        ('{$VARNISH_CACHE.LLD_UPDATE_INTERVAL}', '3600s'),

                        ('{$VARNISH_CACHE.ITEM_HISTORY_STORAGE_PERIOD}', '30d'),
                        ('{$VARNISH_CACHE.ITEM_TREND_STORAGE_PERIOD}', '365d'),
                        ('{$VARNISH_CACHE.ITEM_UPDATE_INTERVAL}', '60s'),

                        ('{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.BACKEND_CONNECTION_FAILURES_RATE.SAMPLES}', '#10'),
                        ('{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.HTTP_HEADER_OVERFLOWS_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.LRU_NUKED_OBJECTS_RATE.RECOVERY.SAMPLES}', '#10'),
                        ('{$VARNISH_CACHE.MAIN_UPTIME.MIN}', '600s'),
                        ('{$VARNISH_CACHE.MGT_UPTIME.MIN}', '600s'),
                        ('{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.NUKE_LIMIT_REACHS_RATE.RECOVERY.SAMPLES}', '#10'),
                        ('{$VARNISH_CACHE.THREADS.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.THREADS.MAX}', '1000'),
                        ('{$VARNISH_CACHE.VCL_FAILURES_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.VCL_FAILURES_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.WORKSPACE_OVERFLOWS_RATE.MAX}', '0.0'),

                        ('{$VARNISH_CACHE.BACKEND_HEALTHINESS.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.BACKEND_HEALTHINESS.SAMPLES}', '#1'),

                        ('{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.MAX}', '0.0'),
                        ('{$VARNISH_CACHE.ALLOCATOR_FAILURES_RATE.RECOVERY.SAMPLES}', '#10'),
                        ('{$VARNISH_CACHE.SPARE_NODES.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.SPARE_NODES.MIN}', '900000'),
                        ('{$VARNISH_CACHE.SPARE_NODES.RECOVERY.MIN}', '1000000'),

                        ('{$VARNISH_CACHE.MSE_BOOK_SPACE.ENABLED}', '1'),
                        ('{$VARNISH_CACHE.MSE_BOOK_SPACE.MIN}', '75MB'),
                        ('{$VARNISH_CACHE.MSE_BOOK_SPACE.RECOVERY.MIN}', '100MB'),
                    ] %}
                    <macro>
                        <macro>{{ macro[0]|e }}</macro>
                        <value>{{ macro[1]|e }}</value>
                    </macro>
                {% endfor %}
            </macros>
        </template>
    </templates>
</zabbix_export>
